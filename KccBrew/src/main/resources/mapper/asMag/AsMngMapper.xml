<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.kccbrew.asMng.dao.IAsMngRepository">

<select id="selectASList" parameterType="kr.co.kccbrew.asMng.model.AsMngVo" resultType="kr.co.kccbrew.asMng.model.AsMngVo">
	SELECT as_info_seq AS "asInfoSeq",
		status.as_status AS "as_status", 
		s.store_nm AS "storeNm",
		s.store_addr AS "storeAddr",
		machine.machine_cd AS "machineCd",
		a.reg_dttm AS "regDttm" 
	FROM as_information a 
	INNER JOIN store_user_map su ON a.store_mng_id=su.user_id
	INNER JOIN users u ON su.user_id=u.user_id 
	INNER JOIN store s ON s.store_seq=su.store_seq
	INNER JOIN (select grp_cd_dtl_nm AS as_status ,grp_cd_dtl_id from group_code_detail where grp_cd_id LIKE 'S') status ON status.grp_cd_dtl_id=a.as_status
	INNER JOIN (select grp_cd_dtl_nm AS machine_cd ,grp_cd_dtl_id from group_code_detail where grp_cd_id like 'M') machine on machine.grp_cd_dtl_id=a.machine_cd
	WHERE 
		<choose><when test="asInfoSeq != null">a.as_info_seq = #{asInfoSeq} </when></choose>
		<choose><when test="storeAddr != null"> AND s.store_addr LIKE '%'||#{storeAddr}||'%' </when></choose>
		<choose><when test="machineCd != null">AND  machine.machine_cd LIKE '%'||#{machineCd}||'%' </when></choose> 
		<choose><when test="statusCd != null">AND status.as_status LIKE '%'||#{statusCd}||'%' </when></choose> 
		<choose><when test="storeNm != null">AND  s.store_nm LIKE '%'||#{storeNm}||'%' </when></choose> 
		<choose><when test="userId != null">AND (u.user_id =#{userId} AND u.user_type_cd='03')</when></choose>
		AND 
		a.mod_dttm 
			BETWEEN 
			<choose><when test="startDate != null">#{startDate}</when><otherwise>''</otherwise></choose> 
			AND 
			<choose><when test="endDate != null">#{endDate}</when><otherwise>''</otherwise></choose>
</select>

<select id="selectMachineCd" resultType="kr.co.kccbrew.asMng.model.AsMngVo">
<![CDATA[
	SELECT grp_cd_dtl_id AS "grpCdDtlId", grp_cd_id AS "grpCdId", grp_cd_dtl_nm AS "grpCdDtlNm" 
	FROM group_code_detail WHERE grp_cd_id LIKE 'M'
]]>
</select>

<select id="selectAsStatusCd" resultType="kr.co.kccbrew.asMng.model.AsMngVo">
<![CDATA[
	SELECT grp_cd_dtl_id AS "grpCdDtlId", grp_cd_id AS "grpCdId", grp_cd_dtl_nm AS "grpCdDtlNm" 
	FROM group_code_detail WHERE grp_cd_id LIKE 'S'
]]>
</select>

<select id="selectLocationCd" resultType="kr.co.kccbrew.asMng.model.AsMngVo">
<![CDATA[
	SELECT grp_cd_dtl_id AS "grpCdDtlId", grp_cd_id AS "grpCdId", grp_cd_dtl_nm AS "grpCdDtlNm" 
	FROM group_code_detail WHERE grp_cd_id LIKE 'LL'
]]>
</select>


</mapper>